(function(n){var s={series:{stack:null}};function i(n){function s(n,s){var t=null;for(var i=0;i<s.length;++i){if(n==s[i])break;if(s[i].stack==n.stack)t=s[i]};return t};function i(m,r,v){if(r.stack==null||r.stack===!1)return;var y=s(r,m.getData());if(!y)return;var t=v.pointsize,o=v.points,h=y.datapoints.pointsize,u=y.datapoints.points,i=[],c,D,Q,a,p,k,b=r.lines.show,d=r.bars.horizontal,j=t>2&&(d?v.format[2].x:v.format[2].y),x=b&&r.lines.steps,w=!0,z=d?1:0,g=d?0:1,e=0,f=0,l,n;while(!0){if(e>=o.length)break;l=i.length;if(o[e]==null){for(n=0;n<t;++n)i.push(o[e+n]);e+=t}else if(f>=u.length){if(!b){for(n=0;n<t;++n)i.push(o[e+n])};e+=t}else if(u[f]==null){for(n=0;n<t;++n)i.push(null);w=!0;f+=h}else{c=o[e+z];D=o[e+g];a=u[f+z];p=u[f+g];k=0;if(c==a){for(n=0;n<t;++n)i.push(o[e+n]);i[l+g]+=p;k=p;e+=t;f+=h}else if(c>a){if(b&&e>0&&o[e-t]!=null){Q=D+(o[e-t+g]-D)*(a-c)/(o[e-t+z]-c);i.push(a);i.push(Q+p);for(n=2;n<t;++n)i.push(o[e+n]);k=p};f+=h}else{if(w&&b){e+=t;continue};for(n=0;n<t;++n)i.push(o[e+n]);if(b&&f>0&&u[f-h]!=null)k=p+(u[f-h+g]-p)*(c-a)/(u[f-h+z]-a);i[l+g]+=k;e+=t};w=!1;if(l!=i.length&&j)i[l+2]+=k};if(x&&l!=i.length&&l>0&&i[l]!=null&&i[l]!=i[l-t]&&i[l+1]!=i[l-t+1]){for(n=0;n<t;++n)i[l+t+n]=i[l+n];i[l+1]=i[l-t+1]}};v.points=i};n.hooks.processDatapoints.push(i)};n.plot.plugins.push({init:i,options:s,name:'stack',version:'1.2'})})(jQuery);