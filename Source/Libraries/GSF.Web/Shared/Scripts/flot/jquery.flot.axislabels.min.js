(function(t){var h={axisLabels:{show:!0}};function n(){return!!document.createElement('canvas').getContext};function r(){if(!n()){return!1};var t=document.createElement('canvas'),i=t.getContext('2d');return typeof i.fillText=='function'};function a(){var t=document.createElement('div');return typeof t.style.MozTransition!='undefined'||typeof t.style.OTransition!='undefined'||typeof t.style.webkitTransition!='undefined'||typeof t.style.transition!='undefined'};function l(t,i,e,s,o){this.axisName=t;this.position=i;this.padding=e;this.plot=s;this.opts=o;this.width=0;this.height=0};l.prototype.cleanup=function(){};s.prototype=new l();s.prototype.constructor=s;function s(t,i,e,s,o){l.prototype.constructor.call(this,t,i,e,s,o)};s.prototype.calculateSize=function(){if(!this.opts.axisLabelFontSizePixels)this.opts.axisLabelFontSizePixels=14;if(!this.opts.axisLabelFontFamily)this.opts.axisLabelFontFamily='sans-serif';var t=this.opts.axisLabelFontSizePixels+this.padding,i=this.opts.axisLabelFontSizePixels+this.padding;if(this.position=='left'||this.position=='right'){this.width=this.opts.axisLabelFontSizePixels+this.padding;this.height=0}else{this.width=0;this.height=this.opts.axisLabelFontSizePixels+this.padding}};s.prototype.draw=function(t){if(!this.opts.axisLabelColour)this.opts.axisLabelColour='black';var i=this.plot.getCanvas().getContext('2d');i.save();i.font=this.opts.axisLabelFontSizePixels+'px '+this.opts.axisLabelFontFamily;i.fillStyle=this.opts.axisLabelColour;var o=i.measureText(this.opts.axisLabel).width,l=this.opts.axisLabelFontSizePixels,e,s,a=0;if(this.position=='top'){e=t.left+t.width/2-o/2;s=t.top+l*0.72}else if(this.position=='bottom'){e=t.left+t.width/2-o/2;s=t.top+t.height-l*0.72}else if(this.position=='left'){e=t.left+l*0.72;s=t.height/2+t.top+o/2;a=-Math.PI/2}else if(this.position=='right'){e=t.left+t.width-l*0.72;s=t.height/2+t.top-o/2;a=Math.PI/2};i.translate(e,s);i.rotate(a);i.fillText(this.opts.axisLabel,0,0);i.restore()};e.prototype=new l();e.prototype.constructor=e;function e(t,i,e,s,o){l.prototype.constructor.call(this,t,i,e,s,o);this.elem=null};e.prototype.calculateSize=function(){var i=t('<div class="axisLabels" style="position:absolute;">'+this.opts.axisLabel+'</div>');this.plot.getPlaceholder().append(i);this.labelWidth=i.outerWidth(!0);this.labelHeight=i.outerHeight(!0);i.remove();this.width=this.height=0;if(this.position=='left'||this.position=='right'){this.width=this.labelWidth+this.padding}else{this.height=this.labelHeight+this.padding}};e.prototype.cleanup=function(){if(this.elem){this.elem.remove()}};e.prototype.draw=function(i){this.plot.getPlaceholder().find('#'+this.axisName+'Label').remove();this.elem=t('<div id="'+this.axisName+'Label" " class="axisLabels" style="position:absolute;">'+this.opts.axisLabel+'</div>');this.plot.getPlaceholder().append(this.elem);if(this.position=='top'){this.elem.css('left',i.left+i.width/2-this.labelWidth/2+'px');this.elem.css('top',i.top+'px')}else if(this.position=='bottom'){this.elem.css('left',i.left+i.width/2-this.labelWidth/2+'px');this.elem.css('top',i.top+i.height-this.labelHeight+'px')}else if(this.position=='left'){this.elem.css('top',i.top+i.height/2-this.labelHeight/2+'px');this.elem.css('left',i.left+'px')}else if(this.position=='right'){this.elem.css('top',i.top+i.height/2-this.labelHeight/2+'px');this.elem.css('left',i.left+i.width-this.labelWidth+'px')}};i.prototype=new e();i.prototype.constructor=i;function i(t,i,s,o,l){e.prototype.constructor.call(this,t,i,s,o,l)};i.prototype.calculateSize=function(){e.prototype.calculateSize.call(this);this.width=this.height=0;if(this.position=='left'||this.position=='right'){this.width=this.labelHeight+this.padding}else{this.height=this.labelHeight+this.padding}};i.prototype.transforms=function(t,i,s){var e={'-moz-transform':'','-webkit-transform':'','-o-transform':'','-ms-transform':''};if(i!=0||s!=0){var l=' translate('+i+'px, '+s+'px)';e['-moz-transform']+=l;e['-webkit-transform']+=l;e['-o-transform']+=l;e['-ms-transform']+=l};if(t!=0){var n=t/90,o=' rotate('+t+'deg)';e['-moz-transform']+=o;e['-webkit-transform']+=o;e['-o-transform']+=o;e['-ms-transform']+=o};var h='top: 0; left: 0; ';for(var a in e){if(e[a]){h+=a+':'+e[a]+';'}};h+=';';return h};i.prototype.calculateOffsets=function(t){var i={x:0,y:0,degrees:0};if(this.position=='bottom'){i.x=t.left+t.width/2-this.labelWidth/2;i.y=t.top+t.height-this.labelHeight}else if(this.position=='top'){i.x=t.left+t.width/2-this.labelWidth/2;i.y=t.top}else if(this.position=='left'){i.degrees=-90;i.x=t.left-this.labelWidth/2+this.labelHeight/2;i.y=t.height/2+t.top}else if(this.position=='right'){i.degrees=90;i.x=t.left+t.width-this.labelWidth/2-this.labelHeight/2;i.y=t.height/2+t.top};i.x=Math.round(i.x);i.y=Math.round(i.y);return i};i.prototype.draw=function(i){this.plot.getPlaceholder().find('.'+this.axisName+'Label').remove();var e=this.calculateOffsets(i);this.elem=t('<div class="axisLabels '+this.axisName+'Label" style="position:absolute; '+this.transforms(e.degrees,e.x,e.y)+'">'+this.opts.axisLabel+'</div>');this.plot.getPlaceholder().append(this.elem)};o.prototype=new i();o.prototype.constructor=o;function o(t,e,s,o,l){i.prototype.constructor.call(this,t,e,s,o,l);this.requiresResize=!1};o.prototype.transforms=function(t,i,e){var s='';if(t!=0){var o=t/90;while(o<0){o+=4};s+=' filter: progid:DXImageTransform.Microsoft.BasicImage(rotation='+o+'); ';this.requiresResize=(this.position=='right')};if(i!=0){s+='left: '+i+'px; '};if(e!=0){s+='top: '+e+'px; '};return s};o.prototype.calculateOffsets=function(t){var e=i.prototype.calculateOffsets.call(this,t);if(this.position=='top'){e.y=t.top+1}else if(this.position=='left'){e.x=t.left;e.y=t.height/2+t.top-this.labelWidth/2}else if(this.position=='right'){e.x=t.left+t.width-this.labelHeight;e.y=t.height/2+t.top-this.labelWidth/2};return e};o.prototype.draw=function(t){i.prototype.draw.call(this,t);if(this.requiresResize){this.elem=this.plot.getPlaceholder().find('.'+this.axisName+'Label');this.elem.css('width',this.labelWidth);this.elem.css('height',this.labelHeight)}};function p(l){l.hooks.processOptions.push(function(l,h){if(!h.axisLabels.show)return;var p=!1,n={};var d={left:0,right:0,top:0,bottom:0};var f=2;l.hooks.draw.push(function(l,h){var d=!1;if(!p){t.each(l.getAxes(),function(t,h){var p=h.options||l.getOptions()[t];if(t in n){h.labelHeight=h.labelHeight-n[t].height;h.labelWidth=h.labelWidth-n[t].width;p.labelHeight=h.labelHeight;p.labelWidth=h.labelWidth;n[t].cleanup();delete n[t]};if(!p||!p.axisLabel||!h.show)return;d=!0;var c=null;if(!p.axisLabelUseHtml&&navigator.appName=='Microsoft Internet Explorer'){var u=navigator.userAgent,g=new RegExp('MSIE ([0-9]{1,}[\.0-9]{0,})');if(g.exec(u)!=null){rv=parseFloat(RegExp.$1)};if(rv>=9&&!p.axisLabelUseCanvas&&!p.axisLabelUseHtml){c=i}else if(!p.axisLabelUseCanvas&&!p.axisLabelUseHtml){c=o}else if(p.axisLabelUseCanvas){c=s}else{c=e}}else{if(p.axisLabelUseHtml||(!a()&&!r())&&!p.axisLabelUseCanvas){c=e}else if(p.axisLabelUseCanvas||!a()){c=s}else{c=i}};var b=p.axisLabelPadding===undefined?f:p.axisLabelPadding;n[t]=new c(t,h.position,b,l,p);n[t].calculateSize();p.labelHeight=h.labelHeight+n[t].height;p.labelWidth=h.labelWidth+n[t].width});if(d){p=!0;l.setupGrid();l.draw()}}else{p=!1;t.each(l.getAxes(),function(t,i){var e=i.options||l.getOptions()[t];if(!e||!e.axisLabel||!i.show)return;n[t].draw(i.box)})}})})};t.plot.plugins.push({init:p,options:h,name:'axisLabels',version:'2.0'})})(jQuery);